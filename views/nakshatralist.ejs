<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=100%, initial-scale=1.0" />
    <title>nakshatralist</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap.min.css"
    />
  </head>

  <body>
    <table id="nakshatraTable" class="table table-striped table-bordered" style="width:100%">
      <thead>
        <tr>
          <th>Birth Moon Sign</th>
          <th>Birth Moon Nakshatra</th>
          <th>Prediction date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <script src="/vendor/jquery/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script>
      let uTable;
      $(document).ready(function() {
        uTable = $("#nakshatraTable").DataTable({
          processing: true,
          paging: true,
          dom: "<'row'<'col-sm-12'tr>>" + "<'row'<'col-sm-4'i><'col-sm-8'<'float-right p-2'p>>>",
          ajax: {
            url: "/api/v1/astro",
            // beforeSend: function (request) {
            //     request.setRequestHeader("access_token", $.cookie("access_token"));
            // },
            dataFilter: data => {
              let json = JSON.parse(data);
              json.recordsTotal = json.total;
              json.recordsFiltered = json.total;
              return JSON.stringify(json);
            },
            data: function(d) {
              return $.extend({}, { start: d.start, limit: d.limit, total: d.length });
            }
          },
          columns: [
            {
              data: "birth_moon_sign"
            },
            {
              data: "birth_moon_nakshatra"
            },
            {
              data: "prediction_date"
            },
            {
              data: null,
              class: "text-center",
              render: (d, type, row, meta) => {
                return `<button type="button" class="btn btn-info" title="Detail" onclick="window.location.replace('/nakshatralist/${d._id}')">Update Sentiment </button>`;
              }
            }
          ]
        });
      });
    </script>
  </body>
</html>
